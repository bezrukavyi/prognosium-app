%md-content.task-content(flex='' ng_if='tasks.currentTask' ng_init='task = tasks.currentTask')

  %md-button#back-task.md-button.md-ink-ripple(ui-sref='projects.detail({projectId: projects.currentProject.id})'
    ng-click='projects.show({id: projects.currentProject.id})')
    %md-icon keyboard_backspace
    To project

  %form#task-form.task-form(layout='column' layout_align='center center' name='editTaskForm')
    %md-input-container.md-block.project-title.read-field(ng_class="{ 'write': editTaskForm.edited }")
      %textarea#title-field.title(data_enter_event='tasks.edit(editTaskForm, task)'
        aria-label='Title'
        md-maxlength='100'
        md-no-asterisk=''
        required=''
        name='title'
        ng_model='task.title')

      %span.hidden {{ task.title }}
      %div.validators(ng_messages='editTaskForm.title.$error')
        %div(ng_message='required') {{ 'validation.required' | translate }}
        %div(ng_message='md-maxlength') {{ 'validation.max_length' | translate:{value: 100} }}

    %md-actions.task-actions(layout='row' layout_align='center')
      %md-button#edit-task.md-ink-ripple.md-icon-button.md-24(aria-label='edit task'
        ng-click='tasks.edit(editTaskForm, task)')

        %md-icon(ng_if='!editTaskForm.edited') edit
        %md-icon(ng_if='editTaskForm.edited') done
      %md-button#delete-task.md-button.md-ink-ripple.md-icon-button.md-24(ng-click='tasks.delete(task, projects.currentProject)')
        %md-icon delete

    %md-button.md-raised.md-primary(layout='row'
      aria-label='create task'
      ngf-change='tasks.upload(projects.currentProject, tasks.currentTask, $file)'
      ngf-select='')
      {{ 'task.upload' | translate }}

      %input.hidden(name='file' type='file'
        ngf-change='tasks.upload(projects.currentProject, tasks.currentTask, $file)'
        ngf-select='')

  .data-content(layout='row' layout_align='space-between start')
    .chart(flex='' layout='row')
      %canvas#line.chart(class="chart chart-line"
        chart-data="[task.initial_data.values]"
        chart-labels="task.initial_data.dates")

    %table.table
      %thead
        %tr
          %th {{ 'data.dates' | translate }}
          %th {{ 'data.values' | translate }}
      %tbody
        %tr(ng_repeat="date in task.initial_data.dates")
          %td {{ date }}
          %td {{ task.initial_data.values[$index] }}
